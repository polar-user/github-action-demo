import{w as ie,a as re,u as K,c as B,b as ce,t as R,d as T,e as G,g as le,n as x,m as _,f as D,I as U,p as se,h as de,i as ue,B as fe,j as N,k as ge,l as me,o as he,q as ve,r as be,s as ye}from"./index-A16L9Gtp.js";import{i as X,w as A,r as P,o as V,n as j,c as t,d as C,g as Z,a as M,m as Y,T as _e,b as xe,e as Pe,f as Se,h as I,j as ke,_ as Be,k as W,l as w,p as H,F as Te,q as Ce,s as we}from"./index-h3MAUAXf.js";const ze="van-hairline",Le=`${ze}--surround`,$e="van-haptics-feedback",Ie=Symbol();function Ee(e){const n=X(Ie,null);n&&A(n,o=>{o&&e()})}const Re=(e,n)=>{const o=P(),i=()=>{o.value=K(e).height};return V(()=>{if(j(i),n)for(let l=1;l<=3;l++)setTimeout(i,100*l)}),Ee(()=>j(i)),A([ie,re],i),o};function Ae(e,n){const o=Re(e,!0);return i=>t("div",{class:n("placeholder"),style:{height:o.value?`${o.value}px`:void 0}},[i()])}const[p,J]=B("action-bar"),ee=Symbol(p),je={placeholder:Boolean,safeAreaInsetBottom:R};var Oe=C({name:p,props:je,setup(e,{slots:n}){const o=P(),i=Ae(o,J),{linkChildren:l}=ce(ee);l();const c=()=>{var s;return t("div",{ref:o,class:[J(),{"van-safe-area-bottom":e.safeAreaInsetBottom}]},[(s=n.default)==null?void 0:s.call(n)])};return()=>e.placeholder?i(c):c()}});const De=T(Oe),ne={to:[String,Object],url:String,replace:Boolean};function Ne({to:e,url:n,replace:o,$router:i}){e&&i?i[o?"replace":"push"](e):n&&(o?location.replace(n):location.href=n)}function te(){const e=Z().proxy;return()=>Ne(e)}const[Ue,E]=B("loading"),Fe=Array(12).fill(null).map((e,n)=>t("i",{class:E("line",String(n+1))},null)),He=t("svg",{class:E("circular"),viewBox:"25 25 50 50"},[t("circle",{cx:"50",cy:"50",r:"20",fill:"none"},null)]),qe={size:x,type:_("circular"),color:String,vertical:Boolean,textSize:x,textColor:String};var Ke=C({name:Ue,props:qe,setup(e,{slots:n}){const o=M(()=>G({color:e.color},le(e.size))),i=()=>{const c=e.type==="spinner"?Fe:He;return t("span",{class:E("spinner",e.type),style:o.value},[n.icon?n.icon():c])},l=()=>{var c;if(n.default)return t("span",{class:E("text"),style:{fontSize:D(e.textSize),color:(c=e.textColor)!=null?c:e.color}},[n.default()])};return()=>{const{type:c,vertical:s}=e;return t("div",{class:E([c,{vertical:s}]),"aria-live":"polite","aria-busy":!0},[i(),l()])}}});const oe=T(Ke),[Ye,z]=B("button"),Ge=G({},ne,{tag:_("button"),text:String,icon:String,type:_("default"),size:_("normal"),color:String,block:Boolean,plain:Boolean,round:Boolean,square:Boolean,loading:Boolean,hairline:Boolean,disabled:Boolean,iconPrefix:String,nativeType:_("button"),loadingSize:x,loadingText:String,loadingType:String,iconPosition:_("left")});var Ve=C({name:Ye,props:Ge,emits:["click"],setup(e,{emit:n,slots:o}){const i=te(),l=()=>o.loading?o.loading():t(oe,{size:e.loadingSize,type:e.loadingType,class:z("loading")},null),c=()=>{if(e.loading)return l();if(o.icon)return t("div",{class:z("icon")},[o.icon()]);if(e.icon)return t(U,{name:e.icon,class:z("icon"),classPrefix:e.iconPrefix},null)},s=()=>{let a;if(e.loading?a=e.loadingText:a=o.default?o.default():e.text,a)return t("span",{class:z("text")},[a])},h=()=>{const{color:a,plain:f}=e;if(a){const d={color:f?a:"white"};return f||(d.background=a),a.includes("gradient")?d.border=0:d.borderColor=a,d}},g=a=>{e.loading?se(a):e.disabled||(n("click",a),i())};return()=>{const{tag:a,type:f,size:d,block:S,round:y,plain:u,square:b,loading:r,disabled:v,hairline:k,nativeType:F,iconPosition:O}=e,ae=[z([f,d,{plain:u,block:S,round:y,square:b,loading:r,disabled:v,hairline:k}]),{[Le]:k}];return t(a,{type:F,class:ae,style:h(),disabled:v,onClick:g},{default:()=>[t("div",{class:z("content")},[O==="left"&&c(),s(),O==="right"&&c()])]})}}});const Me=T(Ve),[We,q]=B("action-bar-icon"),Je=G({},ne,{dot:Boolean,text:String,icon:String,color:String,badge:x,iconClass:de,badgeProps:Object,iconPrefix:String});var Qe=C({name:We,props:Je,setup(e,{slots:n}){const o=te();ue(ee);const i=()=>{const{dot:l,badge:c,icon:s,color:h,iconClass:g,badgeProps:a,iconPrefix:f}=e;return n.icon?t(fe,Y({dot:l,class:q("icon"),content:c},a),{default:n.icon}):t(U,{tag:"div",dot:l,name:s,badge:c,color:h,class:[q("icon"),g],badgeProps:a,classPrefix:f},null)};return()=>t("div",{role:"button",class:q(),tabindex:0,onClick:o},[i(),n.default?n.default():e.text])}});const Xe=T(Qe),Ze=Symbol(),pe=()=>X(Ze,null),[en,Q]=B("tag"),nn={size:String,mark:Boolean,show:R,type:_("default"),color:String,plain:Boolean,round:Boolean,textColor:String,closeable:Boolean};var tn=C({name:en,props:nn,emits:["close"],setup(e,{slots:n,emit:o}){const i=s=>{s.stopPropagation(),o("close",s)},l=()=>e.plain?{color:e.textColor||e.color,borderColor:e.color}:{color:e.textColor,background:e.color},c=()=>{var s;const{type:h,mark:g,plain:a,round:f,size:d,closeable:S}=e,y={mark:g,plain:a,round:f};d&&(y[d]=d);const u=S&&t(U,{name:"cross",class:[Q("close"),$e],onClick:i},null);return t("span",{style:l(),class:Q([y,h])},[(s=n.default)==null?void 0:s.call(n),u])};return()=>t(_e,{name:e.closeable?"van-fade":void 0},{default:()=>[e.show?c():null]})}});const on=T(tn),[an,L]=B("image"),rn={src:String,alt:String,fit:String,position:String,round:Boolean,block:Boolean,width:x,height:x,radius:x,lazyLoad:Boolean,iconSize:x,showError:R,errorIcon:_("photo-fail"),iconPrefix:String,showLoading:R,loadingIcon:_("photo")};var cn=C({name:an,props:rn,emits:["load","error"],setup(e,{emit:n,slots:o}){const i=P(!1),l=P(!0),c=P(),{$Lazyload:s}=Z().proxy,h=M(()=>{const r={width:D(e.width),height:D(e.height)};return N(e.radius)&&(r.overflow="hidden",r.borderRadius=D(e.radius)),r});A(()=>e.src,()=>{i.value=!1,l.value=!0});const g=r=>{l.value&&(l.value=!1,n("load",r))},a=()=>{const r=new Event("load");Object.defineProperty(r,"target",{value:c.value,enumerable:!0}),g(r)},f=r=>{i.value=!0,l.value=!1,n("error",r)},d=(r,v,k)=>k?k():t(U,{name:r,size:e.iconSize,class:v,classPrefix:e.iconPrefix},null),S=()=>{if(l.value&&e.showLoading)return t("div",{class:L("loading")},[d(e.loadingIcon,L("loading-icon"),o.loading)]);if(i.value&&e.showError)return t("div",{class:L("error")},[d(e.errorIcon,L("error-icon"),o.error)])},y=()=>{if(i.value||!e.src)return;const r={alt:e.alt,class:L("img"),style:{objectFit:e.fit,objectPosition:e.position}};return e.lazyLoad?Pe(t("img",Y({ref:c},r),null),[[Se("lazy"),e.src]]):t("img",Y({ref:c,src:e.src,onLoad:g,onError:f},r),null)},u=({el:r})=>{const v=()=>{r===c.value&&l.value&&a()};c.value?v():j(v)},b=({el:r})=>{r===c.value&&!i.value&&f()};return s&&ge&&(s.$on("loaded",u),s.$on("error",b),xe(()=>{s.$off("loaded",u),s.$off("error",b)})),V(()=>{j(()=>{var r;(r=c.value)!=null&&r.complete&&!e.lazyLoad&&a()})}),()=>{var r;return t("div",{class:L({round:e.round,block:e.block}),style:h.value},[y(),S(),(r=o.default)==null?void 0:r.call(o)])}}});const ln=T(cn),[sn,m]=B("card"),dn={tag:String,num:x,desc:String,thumb:String,title:String,price:x,centered:Boolean,lazyLoad:Boolean,currency:_("¥"),thumbLink:String,originPrice:x};var un=C({name:sn,props:dn,emits:["clickThumb"],setup(e,{slots:n,emit:o}){const i=()=>{if(n.title)return n.title();if(e.title)return t("div",{class:[m("title"),"van-multi-ellipsis--l2"]},[e.title])},l=()=>{if(n.tag||e.tag)return t("div",{class:m("tag")},[n.tag?n.tag():t(on,{mark:!0,type:"primary"},{default:()=>[e.tag]})])},c=()=>n.thumb?n.thumb():t(ln,{src:e.thumb,fit:"cover",width:"100%",height:"100%",lazyLoad:e.lazyLoad},null),s=()=>{if(n.thumb||e.thumb)return t("a",{href:e.thumbLink,class:m("thumb"),onClick:a=>o("clickThumb",a)},[c(),l()])},h=()=>{if(n.desc)return n.desc();if(e.desc)return t("div",{class:[m("desc"),"van-ellipsis"]},[e.desc])},g=()=>{const a=e.price.toString().split(".");return t("div",null,[t("span",{class:m("price-currency")},[e.currency]),t("span",{class:m("price-integer")},[a[0]]),I("."),t("span",{class:m("price-decimal")},[a[1]])])};return()=>{var a,f,d;const S=n.num||N(e.num),y=n.price||N(e.price),u=n["origin-price"]||N(e.originPrice),b=S||y||u||n.bottom,r=y&&t("div",{class:m("price")},[n.price?n.price():g()]),v=u&&t("div",{class:m("origin-price")},[n["origin-price"]?n["origin-price"]():`${e.currency} ${e.originPrice}`]),k=S&&t("div",{class:m("num")},[n.num?n.num():`x${e.num}`]),F=n.footer&&t("div",{class:m("footer")},[n.footer()]),O=b&&t("div",{class:m("bottom")},[(a=n["price-top"])==null?void 0:a.call(n),r,v,k,(f=n.bottom)==null?void 0:f.call(n)]);return t("div",{class:m()},[t("div",{class:m("header")},[s(),t("div",{class:m("content",{centered:e.centered})},[t("div",null,[i(),h(),(d=n.tags)==null?void 0:d.call(n)]),O])]),F])}}});const fn=T(un),[gn,$,mn]=B("list"),hn={error:Boolean,offset:me(300),loading:Boolean,disabled:Boolean,finished:Boolean,scroller:Object,errorText:String,direction:_("down"),loadingText:String,finishedText:String,immediateCheck:R};var vn=C({name:gn,props:hn,emits:["load","update:error","update:loading"],setup(e,{emit:n,slots:o}){const i=P(e.loading),l=P(),c=P(),s=pe(),h=he(l),g=M(()=>e.scroller||h.value),a=()=>{j(()=>{if(i.value||e.finished||e.disabled||e.error||(s==null?void 0:s.value)===!1)return;const{direction:u}=e,b=+e.offset,r=K(g);if(!r.height||ye(l))return;let v=!1;const k=K(c);u==="up"?v=r.top-k.top<=b:v=k.bottom-r.bottom<=b,v&&(i.value=!0,n("update:loading",!0),n("load"))})},f=()=>{if(e.finished){const u=o.finished?o.finished():e.finishedText;if(u)return t("div",{class:$("finished-text")},[u])}},d=()=>{n("update:error",!1),a()},S=()=>{if(e.error){const u=o.error?o.error():e.errorText;if(u)return t("div",{role:"button",class:$("error-text"),tabindex:0,onClick:d},[u])}},y=()=>{if(i.value&&!e.finished&&!e.disabled)return t("div",{class:$("loading")},[o.loading?o.loading():t(oe,{class:$("loading-icon")},{default:()=>[e.loadingText||mn("loading")]})])};return A(()=>[e.loading,e.finished,e.error],a),s&&A(s,u=>{u&&a()}),ke(()=>{i.value=e.loading}),V(()=>{e.immediateCheck&&a()}),ve({check:a}),be("scroll",a,{target:g,passive:!0}),()=>{var u;const b=(u=o.default)==null?void 0:u.call(o),r=t("div",{ref:c,class:$("placeholder")},null);return t("div",{ref:l,role:"feed",class:$(),"aria-busy":i.value},[e.direction==="down"?b:r,y(),f(),S(),e.direction==="up"?b:r])}}});const bn=T(vn),yn={data(){return{goods:{title:"美国伽力果213（约680g/3个）",price:2680,express:"免运费",remain:19,thumb:["https://img.yzcdn.cn/public_files/2017/10/24/e5a5a02309a41f9f5def56684808d9ae.jpeg","https://img.yzcdn.cn/public_files/2017/10/24/1791ba14088f9c2be8c610d0a6cc0f93.jpeg"]}}},methods:{formatPrice(){return"¥"+(this.goods.price/100).toFixed(2)},onClickCart(){this.$router.push("cart")},sorry(){showToast("暂无后续逻辑~")},toPlay(){this.$router.push({name:"Player"})}},setup(){const e=P([]),n=P(!1),o=P(!1);return{list:e,onLoad:()=>{setTimeout(()=>{for(let l=0;l<10;l++)e.value.push(e.value.length+1);n.value=!1,e.value.length>=40&&(o.value=!0)},1e3)},loading:n,finished:o}}},_n={class:"goods"};function xn(e,n,o,i,l,c){const s=Me,h=fn,g=bn,a=Xe,f=De;return H(),W("div",_n,[t(g,{loading:i.loading,"onUpdate:loading":n[0]||(n[0]=d=>i.loading=d),finished:i.finished,"finished-text":"没有更多了",onLoad:i.onLoad},{default:w(()=>[(H(!0),W(Te,null,Ce(i.list,d=>(H(),we(h,{key:d,onClick:c.toPlay,desc:"描述信息",centered:"",title:"商品标题",thumb:"https://fastly.jsdelivr.net/npm/@vant/assets/ipad.jpeg"},{footer:w(()=>[t(s,{size:"small"},{default:w(()=>[I("删除")]),_:1}),t(s,{size:"small"},{default:w(()=>[I("转发")]),_:1})]),_:2},1032,["onClick"]))),128))]),_:1},8,["loading","finished","onLoad"]),t(f,null,{default:w(()=>[t(a,{icon:"wap-home-o",onClick:c.sorry},{default:w(()=>[I(" 收藏 ")]),_:1},8,["onClick"]),t(a,{icon:"manager-o",onClick:c.onClickCart},{default:w(()=>[I(" 浏览 ")]),_:1},8,["onClick"])]),_:1})])}const kn=Be(yn,[["render",xn]]);export{kn as default};
